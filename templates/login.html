{% extends "base.html" %}

{% block title %}
    <title>Авторизация - Вход</title>
{% endblock title %}

{% block main_content %}
<div class="main-content">
    <div class="content-block">
        <div class="auth-page">
            <div class="form-container">

                <!-- Отображение flash-сообщений -->
                {% with messages = get_flashed_messages(with_categories=true) %}
                    {% if messages %}
                        {% for category, message in messages %}
                            <p class="alert alert-{{ category }}">{{ message }}</p>
                        {% endfor %}
                    {% endif %}
                {% endwith %}

                <!-- Форма для входа -->
                <div id="login-form">
                    <h2>Войти в аккаунт</h2>
                    <form action="{{ url_for('login') }}" method="POST" id="loginForm">
                        <label for="customer_id">ID клиента:</label>
                        <input type="text" id="customer_id" name="customer_id" pattern="\d+"
                               title="ID должен содержать только цифры" required>

                        <label for="password">Пароль:</label>
                        <input type="password" id="password" name="password" required>

                        <button type="submit">Войти</button>
                    </form>
                    <p>Нет аккаунта? <a href="{{ url_for('registration_page') }}">Зарегистрироваться</a></p>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // Проверка на успешный вход и задержка перед перенаправлением
    window.onload = function() {
        const urlParams = new URLSearchParams(window.location.search);
        if (urlParams.has('success')) {
            setTimeout(() => {
                window.location.href = "{{ url_for('profile') }}";  // Перенаправляем на страницу профиля
            }, 3000);  // 3000 миллисекунд = 3 секунд
        }
    };
</script>

{% endblock main_content %}
